/*
*     jquery.cattags - v0.1.0 - by Van <1321907687@qq.com> 
*     2014-07-14
*     detail at: https://github.com/VanMess/jquery.cattags
*     Copyright (c) 2014 
*/
!function(){for(var a=0,b=["webkit","moz","o","ms"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),!function(a){var b={listTag:"ul",listClass:"tag-list",itemTag:"li",itemClass:"tag-item",allowTyping:!0,color:"default",data:[],afterAppend:null,afterRemove:null},c={},d=function(){var b=0,d=function(a,d){this.options=a,this.init(),d.data("catOrder",b).extend({addNewItem:this.addNewItem.bind(this)}).append(this.listTag),c[b]=d,b++};return d.prototype={init:function(){var b=this.options;this.listTag=a(document.createElement(b.listTag)).addClass(b.listClass).addClass(b.listClass+"-"+b.color),b.allowTyping&&(this.inputer=this.createTyping(),this.listTag.append(this.inputer));for(var c=0;c<b.data.length;c++)this.addNewItem(b.data[c],!0)},addNewItem:function(b,c){if("undefined"!=typeof b&&("string"==typeof b&&(b={value:b}),"undefined"!=typeof b&&"undefined"!=typeof b.value&&b.value.trim())){b.value=b.value.trim();var d=this.options,e=this,f=a("<"+d.itemTag+' class="'+d.itemClass+' " style="display:none"><span>'+b.value+'</span><button type="button" class="tag-close" data-dismiss="'+d.itemClass+'">&times;<span class="sr-only">Close</span></button></'+d.itemTag+">");for(var g in b)f.data(g,b[g]);if(d.allowTyping?this.inputer.before(f):this.listTag.append(f),requestAnimationFrame(function(){f.fadeIn("slow"),f.find(".tag-close").click(function(){e.removeItem(a(this).closest("."+d.itemClass))})}),!c&&d.afterAppend){var h=this.getAllDatas();d.afterAppend.call(this.listTag,f,b,h)}return f}},removeItem:function(b){var c=this.options;if(c.afterRemove){var d=this.getAllDatas();c.afterRemove.call(this.listTag,b,b.data(),d)}b.fadeOut("slow",function(){a(this).remove()})},getAllDatas:function(){var b=this.options,c=[];return this.listTag.find(b.itemTag+"."+b.itemClass).each(function(){c.push(a(this).data())}),c},createTyping:function(){var b=this.options,c=this,d=a("<"+b.itemTag+' class="tag-typing"><input type="text" /></'+b.itemTag+">");return d.find('input[type="text"]').blur(function(){c.addNewItem(a(this).val()),a(this).val("")}).keypress(function(b){13===b.keyCode&&(c.addNewItem(a(this).val()),a(this).val(""))}),d}},d}();a.fn.extend({cattags:function(e){if("string"==typeof e||e instanceof Array){var f=e instanceof Array?e:[e];return this.each(function(){var b=a(this),d=c[b.data("catOrder")];return f.forEach(function(a){d.addNewItem(a)}),b})}return"object"==typeof e||"undefined"==typeof e?(e=e||{},e=a.extend({},b,e),this.each(function(){{var b=a(this),c=b.data(),f=a.extend({},e,c);new d(f,b)}return b})):void 0}})}(jQuery);